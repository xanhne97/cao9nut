<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>B√†i C√†o Online</title>
<script src="/socket.io/socket.io.js"></script>

<style>
body{
  font-family:Arial;
  text-align:center;
  background:linear-gradient(135deg,#0b5,#063);
  color:#fff;
}

.card-wrap{
  display:flex;
  justify-content:center;
  gap:15px;
  margin:20px;
}

.card{
  width:80px;
  height:120px;
  perspective:600px;
}

.inner{
  width:100%;
  height:100%;
  position:relative;
  transform-style:preserve-3d;
  transition:0.6s;
}

.flip .inner{
  transform:rotateY(180deg);
}

.front,.back{
  position:absolute;
  width:100%;
  height:100%;
  border-radius:10px;
  backface-visibility:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  font-weight:bold;
}

.back{
  background:#fff;
  color:#000;
  border:2px solid #333;
  transform:rotateY(180deg);
}

.front{
  background:url('https://upload.wikimedia.org/wikipedia/commons/thumb/5/54/Card_back_05.svg/200px-Card_back_05.svg.png');
  background-size:cover;
}

button{
  padding:10px 20px;
  font-size:16px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
</style>
</head>

<body>

<h2>üÉè B√†i C√†o Online</h2>

<input id="name" placeholder="T√™n b·∫°n">
<button onclick="join()">V√†o b√†n</button>

<div id="players"></div>

<button onclick="deal()">Chia b√†i (ch·ªß b√†n)</button>

<h3>B√†i c·ªßa b·∫°n</h3>
<div class="card-wrap" id="cards"></div>

<button onclick="reveal()">L·∫≠t b√†i</button>

<div id="result"></div>

<script>
const socket=io();
let myCards=[];

const suits=["‚ô†","‚ô•","‚ô¶","‚ô£"];
const ranks=["A","2","3","4","5","6","7","8","9","10","J","Q","K"];

function join(){
  socket.emit("join",document.getElementById("name").value);
}

function deal(){ socket.emit("deal"); }

function reveal(){
  document.querySelectorAll(".card").forEach(c=>c.classList.add("flip"));
  socket.emit("reveal");
}

socket.on("players",(list)=>{
  document.getElementById("players").innerHTML=
    "Ng∆∞·ªùi ch∆°i: "+list.map(p=>p.name).join(", ");
});

socket.on("yourCards",(cards)=>{
  myCards=cards;
  renderCards(false);
});

function renderCards(show){
  let html="";
  myCards.forEach((c,i)=>{
    let rank=ranks[(c-1)%13];
    let suit=suits[Math.floor(Math.random()*4)];
    html+=`
      <div class="card ${show?"flip":""}">
        <div class="inner">
          <div class="front"></div>
          <div class="back">${rank}${suit}</div>
        </div>
      </div>
    `;
  });
  document.getElementById("cards").innerHTML=html;
}

socket.on("showAll",(players)=>{
  let html="<h3>K·∫øt qu·∫£</h3>";
  Object.values(players).forEach(p=>{
    html+=`<p>${p.name}: ${p.cards.join("-")} ‚Üí ${p.score==0?"B√π":p.score}</p>`;
  });
  document.getElementById("result").innerHTML=html;
});

socket.on("winner",(w)=>{
  document.getElementById("result").innerHTML+=
    `<h2>üèÜ ${w.winner} th·∫Øng (${w.max==0?"B√π":w.max})</h2>`;
});
</script>

</body>
</html>